(()=>{var e={951:(e,t)=>{var n,r,i,a;a=function(){var e="BKMGTPEZY".split("");function t(e,t){return e&&e.toLowerCase()===t.toLowerCase()}return function(n,r){return n="number"==typeof n?n:0,(r=r||{}).fixed="number"==typeof r.fixed?r.fixed:2,r.spacer="string"==typeof r.spacer?r.spacer:" ",r.calculate=function(e){var i=t(e,"si")?["k","B"]:["K","iB"],a=t(e,"si")?1e3:1024,s=Math.log(n)/Math.log(a)|0,o=n/Math.pow(a,s),c=o.toFixed(r.fixed);return s-1<3&&!t(e,"si")&&t(e,"jedec")&&(i[1]="B"),{suffix:s?(i[0]+"MGTPEZY")[s-1]+i[1]:1==(0|c)?"Byte":"Bytes",magnitude:s,result:o,fixed:c,bits:{result:o/8,fixed:(o/8).toFixed(r.fixed)}}},r.to=function(r,i){var a=t(i,"si")?1e3:1024,s=e.indexOf("string"==typeof r?r[0].toUpperCase():"B"),o=n;if(-1===s||0===s)return o.toFixed(2);for(;s>0;s--)o/=a;return o.toFixed(2)},r.human=function(e){var t=r.calculate(e);return t.fixed+r.spacer+t.suffix},r}},e.exports?e.exports=a():(r=[],void 0===(i="function"==typeof(n=a)?n.apply(t,r):n)||(e.exports=i))}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e,t,r,i;e={"(":9,"!":8,"*":7,"/":7,"%":7,"+":6,"-":6,"<":5,"<=":5,">":5,">=":5,"==":4,"!=":4,"&&":3,"||":2,"?":1,"?:":1},t=["(","?"],r={")":["("],":":["?","?:"]},i=/<=|>=|==|!=|&&|\|\||\?:|\(|!|\*|\/|%|\+|-|<|>|\?|\)|:/;var a={"!":function(e){return!e},"*":function(e,t){return e*t},"/":function(e,t){return e/t},"%":function(e,t){return e%t},"+":function(e,t){return e+t},"-":function(e,t){return e-t},"<":function(e,t){return e<t},"<=":function(e,t){return e<=t},">":function(e,t){return e>t},">=":function(e,t){return e>=t},"==":function(e,t){return e===t},"!=":function(e,t){return e!==t},"&&":function(e,t){return e&&t},"||":function(e,t){return e||t},"?:":function(e,t,n){if(e)throw t;return n}};function s(n){var s=function(n){for(var a,s,o,c,l=[],d=[];a=n.match(i);){for(s=a[0],(o=n.substr(0,a.index).trim())&&l.push(o);c=d.pop();){if(r[s]){if(r[s][0]===c){s=r[s][1]||s;break}}else if(t.indexOf(c)>=0||e[c]<e[s]){d.push(c);break}l.push(c)}r[s]||d.push(s),n=n.substr(a.index+s.length)}return(n=n.trim())&&l.push(n),l.concat(d.reverse())}(n);return function(e){return function(e,t){var n,r,i,s,o,c,l=[];for(n=0;n<e.length;n++){if(o=e[n],s=a[o]){for(r=s.length,i=Array(r);r--;)i[r]=l.pop();try{c=s.apply(null,i)}catch(e){return e}}else c=t.hasOwnProperty(o)?t[o]:+o;l.push(c)}return l[0]}(s,e)}}var o={contextDelimiter:"",onMissingKey:null};function c(e,t){var n;for(n in this.data=e,this.pluralForms={},this.options={},o)this.options[n]=void 0!==t&&n in t?t[n]:o[n]}c.prototype.getPluralForm=function(e,t){var n,r,i,a=this.pluralForms[e];return a||("function"!=typeof(i=(n=this.data[e][""])["Plural-Forms"]||n["plural-forms"]||n.plural_forms)&&(r=function(e){var t,n,r;for(t=e.split(";"),n=0;n<t.length;n++)if(0===(r=t[n].trim()).indexOf("plural="))return r.substr(7)}(n["Plural-Forms"]||n["plural-forms"]||n.plural_forms),i=function(e){var t=s(e);return function(e){return+t({n:e})}}(r)),a=this.pluralForms[e]=i),a(t)},c.prototype.dcnpgettext=function(e,t,n,r,i){var a,s,o;return a=void 0===i?0:this.getPluralForm(e,i),s=n,t&&(s=t+this.options.contextDelimiter+n),(o=this.data[e][s])&&o[a]?o[a]:(this.options.onMissingKey&&this.options.onMissingKey(n,e),0===a?n:r)};var l={plural_forms:e=>1===e?0:1},d=/^i18n\.(n?gettext|has_translation)(_|$)/;var h=function(e){return"string"!=typeof e||""===e?(console.error("The namespace must be a non-empty string."),!1):!!/^[a-zA-Z][a-zA-Z0-9_.\-\/]*$/.test(e)||(console.error("The namespace can only contain numbers, letters, dashes, periods, underscores and slashes."),!1)};var u=function(e){return"string"!=typeof e||""===e?(console.error("The hook name must be a non-empty string."),!1):/^__/.test(e)?(console.error("The hook name cannot begin with `__`."),!1):!!/^[a-zA-Z][a-zA-Z0-9_.-]*$/.test(e)||(console.error("The hook name can only contain numbers, letters, dashes, periods and underscores."),!1)};var p=function(e,t){return function(n,r,i,a=10){const s=e[t];if(!u(n))return;if(!h(r))return;if("function"!=typeof i)return void console.error("The hook callback must be a function.");if("number"!=typeof a)return void console.error("If specified, the hook priority must be a number.");const o={callback:i,priority:a,namespace:r};if(s[n]){const e=s[n].handlers;let t;for(t=e.length;t>0&&!(a>=e[t-1].priority);t--);t===e.length?e[t]=o:e.splice(t,0,o),s.__current.forEach(e=>{e.name===n&&e.currentIndex>=t&&e.currentIndex++})}else s[n]={handlers:[o],runs:0};"hookAdded"!==n&&e.doAction("hookAdded",n,r,i,a)}};var f=function(e,t,n=!1){return function(r,i){const a=e[t];if(!u(r))return;if(!n&&!h(i))return;if(!a[r])return 0;let s=0;if(n)s=a[r].handlers.length,a[r]={runs:a[r].runs,handlers:[]};else{const e=a[r].handlers;for(let t=e.length-1;t>=0;t--)e[t].namespace===i&&(e.splice(t,1),s++,a.__current.forEach(e=>{e.name===r&&e.currentIndex>=t&&e.currentIndex--}))}return"hookRemoved"!==r&&e.doAction("hookRemoved",r,i),s}};var m=function(e,t){return function(n,r){const i=e[t];return void 0!==r?n in i&&i[n].handlers.some(e=>e.namespace===r):n in i}};var g=function(e,t,n,r){return function(i,...a){const s=e[t];s[i]||(s[i]={handlers:[],runs:0}),s[i].runs++;const o=s[i].handlers;if(!o||!o.length)return n?a[0]:void 0;const c={name:i,currentIndex:0};return(r?async function(){try{s.__current.add(c);let e=n?a[0]:void 0;for(;c.currentIndex<o.length;){const t=o[c.currentIndex];e=await t.callback.apply(null,a),n&&(a[0]=e),c.currentIndex++}return n?e:void 0}finally{s.__current.delete(c)}}:function(){try{s.__current.add(c);let e=n?a[0]:void 0;for(;c.currentIndex<o.length;){e=o[c.currentIndex].callback.apply(null,a),n&&(a[0]=e),c.currentIndex++}return n?e:void 0}finally{s.__current.delete(c)}})()}};var _=function(e,t){return function(){const n=e[t],r=Array.from(n.__current);return r.at(-1)?.name??null}};var y=function(e,t){return function(n){const r=e[t];return void 0===n?r.__current.size>0:Array.from(r.__current).some(e=>e.name===n)}};var v=function(e,t){return function(n){const r=e[t];if(u(n))return r[n]&&r[n].runs?r[n].runs:0}},b=class{actions;filters;addAction;addFilter;removeAction;removeFilter;hasAction;hasFilter;removeAllActions;removeAllFilters;doAction;doActionAsync;applyFilters;applyFiltersAsync;currentAction;currentFilter;doingAction;doingFilter;didAction;didFilter;constructor(){this.actions=Object.create(null),this.actions.__current=new Set,this.filters=Object.create(null),this.filters.__current=new Set,this.addAction=p(this,"actions"),this.addFilter=p(this,"filters"),this.removeAction=f(this,"actions"),this.removeFilter=f(this,"filters"),this.hasAction=m(this,"actions"),this.hasFilter=m(this,"filters"),this.removeAllActions=f(this,"actions",!0),this.removeAllFilters=f(this,"filters",!0),this.doAction=g(this,"actions",!1,!1),this.doActionAsync=g(this,"actions",!1,!0),this.applyFilters=g(this,"filters",!0,!1),this.applyFiltersAsync=g(this,"filters",!0,!0),this.currentAction=_(this,"actions"),this.currentFilter=_(this,"filters"),this.doingAction=y(this,"actions"),this.doingFilter=y(this,"filters"),this.didAction=v(this,"actions"),this.didFilter=v(this,"filters")}};var w=function(){return new b}(),{addAction:x,addFilter:E,removeAction:A,removeFilter:C,hasAction:k,hasFilter:S,removeAllActions:T,removeAllFilters:P,doAction:L,doActionAsync:F,applyFilters:O,applyFiltersAsync:I,currentAction:D,currentFilter:N,doingAction:j,doingFilter:M,didAction:z,didFilter:R,actions:B,filters:U}=w,J=((e,t,n)=>{const r=new c({}),i=new Set,a=()=>{i.forEach(e=>e())},s=(e,t="default")=>{r.data[t]={...r.data[t],...e},r.data[t][""]={...l,...r.data[t]?.[""]},delete r.pluralForms[t]},o=(e,t)=>{s(e,t),a()},h=(e="default",t,n,i,a)=>(r.data[e]||s(void 0,e),r.dcnpgettext(e,t,n,i,a)),u=e=>e||"default",p=(e,t,r)=>{let i=h(r,t,e);return n?(i=n.applyFilters("i18n.gettext_with_context",i,e,t,r),n.applyFilters("i18n.gettext_with_context_"+u(r),i,e,t,r)):i};if(e&&o(e,t),n){const e=e=>{d.test(e)&&a()};n.addAction("hookAdded","core/i18n",e),n.addAction("hookRemoved","core/i18n",e)}return{getLocaleData:(e="default")=>r.data[e],setLocaleData:o,addLocaleData:(e,t="default")=>{r.data[t]={...r.data[t],...e,"":{...l,...r.data[t]?.[""],...e?.[""]}},delete r.pluralForms[t],a()},resetLocaleData:(e,t)=>{r.data={},r.pluralForms={},o(e,t)},subscribe:e=>(i.add(e),()=>i.delete(e)),__:(e,t)=>{let r=h(t,void 0,e);return n?(r=n.applyFilters("i18n.gettext",r,e,t),n.applyFilters("i18n.gettext_"+u(t),r,e,t)):r},_x:p,_n:(e,t,r,i)=>{let a=h(i,void 0,e,t,r);return n?(a=n.applyFilters("i18n.ngettext",a,e,t,r,i),n.applyFilters("i18n.ngettext_"+u(i),a,e,t,r,i)):a},_nx:(e,t,r,i,a)=>{let s=h(a,i,e,t,r);return n?(s=n.applyFilters("i18n.ngettext_with_context",s,e,t,r,i,a),n.applyFilters("i18n.ngettext_with_context_"+u(a),s,e,t,r,i,a)):s},isRTL:()=>"rtl"===p("ltr","text direction"),hasTranslation:(e,t,i)=>{const a=t?t+""+e:e;let s=!!r.data?.[i??"default"]?.[a];return n&&(s=n.applyFilters("i18n.has_translation",s,e,t,i),s=n.applyFilters("i18n.has_translation_"+u(i),s,e,t,i)),s}}})(void 0,void 0,w),H=(J.getLocaleData.bind(J),J.setLocaleData.bind(J),J.resetLocaleData.bind(J),J.subscribe.bind(J),J.__.bind(J));J._x.bind(J),J._n.bind(J),J._nx.bind(J),J.isRTL.bind(J),J.hasTranslation.bind(J);var $=function(e){const t=(e,n)=>{const{headers:r={}}=e;for(const i in r)if("x-wp-nonce"===i.toLowerCase()&&r[i]===t.nonce)return n(e);return n({...e,headers:{...r,"X-WP-Nonce":t.nonce}})};return t.nonce=e,t},K=(e,t)=>{let n,r,i=e.path;return"string"==typeof e.namespace&&"string"==typeof e.endpoint&&(n=e.namespace.replace(/^\/|\/$/g,""),r=e.endpoint.replace(/^\//,""),i=r?n+"/"+r:n),delete e.namespace,delete e.endpoint,t({...e,path:i})},Z=e=>(t,n)=>K(t,t=>{let r,i=t.url,a=t.path;return"string"==typeof a&&(r=e,-1!==e.indexOf("?")&&(a=a.replace("?","&")),a=a.replace(/^\//,""),"string"==typeof r&&-1!==r.indexOf("?")&&(a=a.replace("?","&")),i=r+a),n({...t,url:i})});function q(e){const t=e.split("?"),n=t[1],r=t[0];return n?r+"?"+n.split("&").map(e=>e.split("=")).map(e=>e.map(decodeURIComponent)).sort((e,t)=>e[0].localeCompare(t[0])).map(e=>e.map(encodeURIComponent)).map(e=>e.join("=")).join("&"):r}function G(e){try{return decodeURIComponent(e)}catch(t){return e}}function X(e){return(function(e){let t;try{t=new URL(e,"http://example.com").search.substring(1)}catch(e){}if(t)return t}(e)||"").replace(/\+/g,"%20").split("&").reduce((e,t)=>{const[n,r=""]=t.split("=").filter(Boolean).map(G);if(n){!function(e,t,n){const r=t.length,i=r-1;for(let a=0;a<r;a++){let r=t[a];!r&&Array.isArray(e)&&(r=e.length.toString()),r=["__proto__","constructor","prototype"].includes(r)?r.toUpperCase():r;const s=!isNaN(Number(t[a+1]));e[r]=a===i?n:e[r]||(s?[]:{}),Array.isArray(e[r])&&!s&&(e[r]={...e[r]}),e=e[r]}}(e,n.replace(/\]/g,"").split("["),r)}return e},Object.create(null))}function W(e){let t="";const n=Object.entries(e);let r;for(;r=n.shift();){let[e,i]=r;if(Array.isArray(i)||i&&i.constructor===Object){const t=Object.entries(i).reverse();for(const[r,i]of t)n.unshift([`${e}[${r}]`,i])}else void 0!==i&&(null===i&&(i=""),t+="&"+[e,String(i)].map(encodeURIComponent).join("="))}return t.substr(1)}function Y(e="",t){if(!t||!Object.keys(t).length)return e;const n=function(e){const t=/^\S+?(#[^\s\?]*)/.exec(e);if(t)return t[1]}(e)||"";let r=e.replace(n,"");const i=e.indexOf("?");return-1!==i&&(t=Object.assign(X(e),t),r=r.substr(0,i)),r+"?"+W(t)+n}function Q(e,t){if(t)return Promise.resolve(e.body);try{return Promise.resolve(new window.Response(JSON.stringify(e.body),{status:200,statusText:"OK",headers:e.headers}))}catch{return Object.entries(e.headers).forEach(([t,n])=>{"link"===t.toLowerCase()&&(e.headers[t]=n.replace(/<([^>]+)>/,(e,t)=>`<${encodeURI(t)}>`))}),Promise.resolve(t?e.body:new window.Response(JSON.stringify(e.body),{status:200,statusText:"OK",headers:e.headers}))}}var V=function(e){const t=Object.fromEntries(Object.entries(e).map(([e,t])=>[q(e),t]));return(e,n)=>{const{parse:r=!0}=e;let i=e.path;if(!i&&e.url){const{rest_route:t,...n}=X(e.url);"string"==typeof t&&(i=Y(t,n))}if("string"!=typeof i)return n(e);const a=e.method||"GET",s=q(i);if("GET"===a&&t[s]){const e=t[s];return delete t[s],Q(e,!!r)}if("OPTIONS"===a&&t[a]&&t[a][s]){const e=t[a][s];return delete t[a][s],Q(e,!!r)}return n(e)}},ee=({path:e,url:t,...n},r)=>({...n,url:t&&Y(t,r),path:e&&Y(e,r)}),te=e=>e.json?e.json():Promise.reject(e),ne=e=>{const{next:t}=(e=>{if(!e)return{};const t=e.match(/<([^>]+)>; rel="next"/);return t?{next:t[1]}:{}})(e.headers.get("link"));return t},re=async(e,t)=>{if(!1===e.parse)return t(e);if(!(e=>{const t=!!e.path&&-1!==e.path.indexOf("per_page=-1"),n=!!e.url&&-1!==e.url.indexOf("per_page=-1");return t||n})(e))return t(e);const n=await ve({...ee(e,{per_page:100}),parse:!1}),r=await te(n);if(!Array.isArray(r))return r;let i=ne(n);if(!i)return r;let a=[].concat(r);for(;i;){const t=await ve({...e,path:void 0,url:i,parse:!1}),n=await te(t);a=a.concat(n),i=ne(t)}return a},ie=new Set(["PATCH","PUT","DELETE"]),ae="GET";function se(e,t){return X(e)[t]}function oe(e,t){return void 0!==se(e,t)}async function ce(e){try{return await e.json()}catch{throw{code:"invalid_json",message:H("The response is not a valid JSON response.")}}}async function le(e,t=!0){return t?204===e.status?null:await ce(e):e}async function de(e,t=!0){if(!t)throw e;throw await ce(e)}var he=(e,t)=>{if(!function(e){const t=!!e.method&&"POST"===e.method;return(!!e.path&&-1!==e.path.indexOf("/wp/v2/media")||!!e.url&&-1!==e.url.indexOf("/wp/v2/media"))&&t}(e))return t(e);let n=0;const r=e=>(n++,t({path:`/wp/v2/media/${e}/post-process`,method:"POST",data:{action:"create-image-subsizes"},parse:!1}).catch(()=>n<5?r(e):(t({path:`/wp/v2/media/${e}?force=true`,method:"DELETE"}),Promise.reject())));return t({...e,parse:!1}).catch(t=>{if(!(t instanceof globalThis.Response))return Promise.reject(t);const n=t.headers.get("x-wp-upload-attachment-id");return t.status>=500&&t.status<600&&n?r(n).catch(()=>!1!==e.parse?Promise.reject({code:"post_process",message:H("Media upload failed. If this is a photo or a large image, please scale it down and try again.")}):Promise.reject(t)):de(t,e.parse)}).then(t=>le(t,e.parse))};function ue(e,...t){const n=e.replace(/^[^#]*/,""),r=(e=e.replace(/#.*/,"")).indexOf("?");if(-1===r)return e+n;const i=X(e),a=e.substr(0,r);t.forEach(e=>delete i[e]);const s=W(i);return(s?a+"?"+s:a)+n}var pe=e=>(t,n)=>{if("string"==typeof t.url){const n=se(t.url,"wp_theme_preview");void 0===n?t.url=Y(t.url,{wp_theme_preview:e}):""===n&&(t.url=ue(t.url,"wp_theme_preview"))}if("string"==typeof t.path){const n=se(t.path,"wp_theme_preview");void 0===n?t.path=Y(t.path,{wp_theme_preview:e}):""===n&&(t.path=ue(t.path,"wp_theme_preview"))}return n(t)},fe={Accept:"application/json, */*;q=0.1"},me={credentials:"include"},ge=[(e,t)=>("string"!=typeof e.url||oe(e.url,"_locale")||(e.url=Y(e.url,{_locale:"user"})),"string"!=typeof e.path||oe(e.path,"_locale")||(e.path=Y(e.path,{_locale:"user"})),t(e)),K,(e,t)=>{const{method:n=ae}=e;return ie.has(n.toUpperCase())&&(e={...e,headers:{...e.headers,"X-HTTP-Method-Override":n,"Content-Type":"application/json"},method:"POST"}),t(e)},re];var _e=e=>{const{url:t,path:n,data:r,parse:i=!0,...a}=e;let{body:s,headers:o}=e;o={...fe,...o},r&&(s=JSON.stringify(r),o["Content-Type"]="application/json");return globalThis.fetch(t||n||window.location.href,{...me,...a,body:s,headers:o}).then(e=>e.ok?le(e,i):de(e,i),e=>{if(e&&"AbortError"===e.name)throw e;if(!globalThis.navigator.onLine)throw{code:"offline_error",message:H("Unable to connect. Please check your Internet connection.")};throw{code:"fetch_error",message:H("Could not get a valid response from the server.")}})};var ye=e=>ge.reduceRight((e,t)=>n=>t(n,e),_e)(e).catch(t=>"rest_cookie_invalid_nonce"!==t.code?Promise.reject(t):globalThis.fetch(ye.nonceEndpoint).then(e=>e.ok?e.text():Promise.reject(t)).then(t=>(ye.nonceMiddleware.nonce=t,ye(e))));ye.use=function(e){ge.unshift(e)},ye.setFetchHandler=function(e){_e=e},ye.createNonceMiddleware=$,ye.createPreloadingMiddleware=V,ye.createRootURLMiddleware=Z,ye.fetchAllMiddleware=re,ye.mediaUploadMiddleware=he,ye.createThemePreviewMiddleware=pe;var ve=ye,be=n(951),we=n.n(be);const xe={controlled:null,bind(e){this.controlled=e,this.controlled.forEach(e=>{this._main(e)}),this._init()},_init(){this.controlled.forEach(e=>{this._checkUp(e)})},_main(e){const t=JSON.parse(e.dataset.main);e.dataset.size&&(e.filesize=parseInt(e.dataset.size,10)),e.mains=t.map(t=>{const n=document.getElementById(t),r=document.getElementById(t+"_size_wrapper");return r&&(n.filesize=0,n.sizespan=r),this._addChild(n,e),n}),this._bindEvents(e),e.mains.forEach(e=>{this._bindEvents(e)})},_bindEvents(e){e.eventBound||(e.addEventListener("click",t=>{const n=t.target;n.elements&&(this._checkDown(n),this._evaluateSize(n)),n.mains&&this._checkUp(e)}),e.eventBound=!0)},_addChild(e,t){const n=e.elements?e.elements:[];-1===n.indexOf(t)&&(n.push(t),e.elements=n)},_removeChild(e,t){const n=e.elements.indexOf(t);-1<n&&e.elements.splice(n,1)},_checkDown(e){e.elements&&(e.classList.remove("partial"),e.elements.forEach(t=>{t.checked!==e.checked&&(t.checked=e.checked,t.disabled&&(t.checked=!1),t.dispatchEvent(new Event("change")))}),e.elements.forEach(t=>{this._checkDown(t),t.elements||this._checkUp(t,e)}))},_checkUp(e,t){e.mains&&[...e.mains].forEach(e=>{e!==t&&this._evaluateCheckStatus(e),this._checkUp(e),this._evaluateSize(e)})},_evaluateCheckStatus(e){let t=0,n=e.classList.contains("partial");n&&(e.classList.remove("partial"),n=!1),e.elements.forEach(r=>{null!==r.parentNode?(t+=r.checked,r.classList.contains("partial")&&(n=!0)):this._removeChild(e,r)});let r="some";t===e.elements.length?r="on":0===t?r="off":n=!0,n&&e.classList.add("partial");const i="off"!==r;e.checked===i&&e.value===r||(e.value=r,e.checked=i,e.dispatchEvent(new Event("change")))},_evaluateSize(e){if(e.sizespan&&e.elements){e.filesize=0,e.elements.forEach(t=>{t.checked&&(e.filesize+=t.filesize)});let t=null;0<e.filesize&&(t=we()(e.filesize,{spacer:" "}).human("jedec")),e.sizespan.innerText=t}}},Ee={key:"_cld_pending_state",data:null,pending:null,changed:!1,previous:{},init(){this.data=cldData.stateData?cldData.stateData:{};let e=localStorage.getItem(this.key);e&&(e=JSON.parse(e),this.data={...this.data,...e},this.sendStates()),this.previous=JSON.stringify(this.data)},_update(){this.pending&&(clearTimeout(this.pending),localStorage.removeItem(this.key)),this.previous!==JSON.stringify(this.data)&&(this.pending=setTimeout(()=>this.sendStates(),2e3),localStorage.setItem(this.key,JSON.stringify(this.data)))},set(e,t){this.data[e]&&this.data[e]===t||(this.data[e]=t,this._update())},get(e){let t=null;return this.data[e]&&(t=this.data[e]),t},sendStates(){fetch(cldData.stateURL,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":cldData.stateNonce},body:JSON.stringify(this.data)}).then(e=>e.json()).then(e=>{e.success&&(this.previous=JSON.stringify(e.state),localStorage.removeItem(this.key))})}},Ae={cachePoints:{},spinners:{},states:null,init(e,t){if(this.states=t,"undefined"!=typeof CLDASSETS){ve.use(ve.createNonceMiddleware(CLDASSETS.nonce));e.querySelectorAll("[data-cache-point]").forEach(e=>this._bind(e));const t=document.getElementById("connect.cache.cld_purge_all");t&&(t.disabled="disabled",t.style.width="100px",t.style.transition="width 0.5s",t.addEventListener("click",()=>{t.dataset.purging||confirm(wp.i18n.__("Purge entire cache?","cloudinary"))&&this._purgeAll(t,!1)}),this._watchPurge(t),setInterval(()=>{this._watchPurge(t)},5e3))}},getCachePoint(e){return this.cachePoints["_"+e]?this.cachePoints["_"+e]:null},setCachePoint(e,t){const n=document.getElementById(t.dataset.slug),r=document.createElement("div"),i=this._getRow(),a=document.createElement("td");a.colSpan=2,a.className="cld-loading",i.appendChild(a);const s=document.getElementById(t.dataset.slug+"_search"),o=document.getElementById(t.dataset.slug+"_reload"),c=document.getElementById(t.dataset.browser),l=document.getElementById(t.dataset.apply);l.style.float="right",l.style.marginLeft="6px",c.addEventListener("change",t=>{this._handleManager(e)}),n.addEventListener("change",t=>{this._handleManager(e)}),window.addEventListener("CacheToggle",e=>{e.detail.cachePoint===t&&this._cacheChange(t,e.detail)}),l.addEventListener("click",e=>{this._applyChanges(t)}),o.addEventListener("click",t=>{this._load(e)}),s.addEventListener("keydown",t=>{13===t.which&&(t.preventDefault(),t.stopPropagation(),this._load(e))}),r.className="cld-pagenav",l.cacheChanges={disable:[],enable:[],delete:[]},t.main=n,t.search=s,t.controller=c,t.viewer=t.parentNode.parentNode,t.loader=i,t.table=t.parentNode,t.apply=l,t.paginate=r,t.currentPage=1,t.viewer.appendChild(r),this.cachePoints["_"+e]=t},close(e){e.classList.add("closed")},open(e){e.classList.remove("closed")},isOpen(e){const t=this.getCachePoint(e);let n=!1;return t&&(n=t.controller.checked&&t.main.checked),n},_bind(e){const t=e.dataset.cachePoint;this.setCachePoint(t,e),this._handleManager(t)},_handleManager(e){const t=this.getCachePoint(e);t&&(this.isOpen(e)?(this.open(t.viewer),this.states.set(t.viewer.id,"open"),t.loaded||this._load(e)):(this.close(t.viewer),t.controller.checked=!1,this.states.set(t.viewer.id,"close")))},_load(e){const t=this.getCachePoint(e);let n="100px";t.clientHeight&&(n=t.clientHeight-16+"px"),this._clearChildren(t),t.appendChild(t.loader),this.open(t.loader),t.loader.firstChild.style.height=n,ve({path:CLDASSETS.fetch_url,data:{ID:e,page:t.currentPage,search:t.search.value},method:"POST"}).then(e=>{t.removeChild(t.loader),this._buildList(t,e.items),this._buildNav(t,e);const n=t.querySelectorAll("[data-main]");xe.bind(n),t.loaded=!0})},_cacheChange(e,t){const n=t.checked?t.states.on:t.states.off,r=t.checked?t.states.off:t.states.on;this._removeFromList(e,t.item.ID,r)||this._addToList(e,t.item.ID,n),this._evaluateApply(e)},_evaluateApply(e){e.apply.disabled="disabled";const t=e.apply.cacheChanges;let n=!1;for(const e in t)t[e].length&&(n=!0);n&&(e.apply.disabled="")},_applyChanges(e){const t=e.apply.cacheChanges;e.apply.disabled="disabled";for(const n in t)t[n].length&&this._set_state(e,n,t[n])},_watchPurge(e){e.dataset.purging||e.dataset.updating||(e.dataset.updating=!0,ve({path:CLDASSETS.purge_all,data:{count:!0},method:"POST"}).then(t=>{e.dataset.updating="",0<t.percent&&100>t.percent?(e.disabled="",this._purgeAll(e,!0)):0<t.pending?e.disabled="":e.disabled="disabled"}))},_purgeAll(e,t,n){e.blur();e.dataset.purging=!0,e.style.width="200px",e.style.border="0",e.dataset.title=e.innerText,e.innerText=H("Purging cache 0%","cloudinary"),e.style.backgroundImage="linear-gradient(90deg, #2a0 0%, #787878 0%)",this._purgeAction(e,t,n)},_purgeAction(e,t,n){const r=e.dataset.parent;ve({path:CLDASSETS.purge_all,data:{count:t,parent:r},method:"POST"}).then(t=>{e.innerText=H("Purging cache","cloudinary")+" "+Math.round(t.percent,2)+"%",e.style.backgroundImage="linear-gradient(90deg, #2a0 "+t.percent+"%, #787878 "+t.percent+"%)",100>t.percent?this._purgeAction(e,!0,n):n?n():(e.innerText=wp.i18n.__("Purge complete.","cloudinary"),setTimeout(()=>{e.dataset.purging="",e.style.backgroundImage="",e.style.minHeight="",e.style.border="",e.style.width="100px",e.disabled="disabled",e.innerText=e.dataset.title},2e3))})},_set_state(e,t,n){this._showSpinners(n),ve({path:CLDASSETS.update_url,data:{state:t,ids:n},method:"POST"}).then(n=>{this._hideSpinners(n),n.forEach(n=>{this._removeFromList(e,n,t),this._evaluateApply(e),e.apply.disabled="disabled"}),"delete"===t&&this._load(e.dataset.cachePoint)})},_showSpinners(e){e.forEach(e=>{this.spinners["spinner_"+e].style.visibility="visible"})},_hideSpinners(e){e.forEach(e=>{this.spinners["spinner_"+e].style.visibility="hidden"})},_removeFromList(e,t,n){const r=this._getListIndex(e,t,n);let i=!1;return-1<r&&(e.apply.cacheChanges[n].splice(r,1),i=!0),i},_addToList(e,t,n){-1===this._getListIndex(e,t,n)&&e.apply.cacheChanges[n].push(t)},_getListIndex:(e,t,n)=>e.apply.cacheChanges[n].indexOf(t),_noCache(e){const t=this._getNote(wp.i18n.__("No files cached.","cloudinary"));e.viewer.appendChild(t),this.close(e.table)},_clearChildren(e){for(;e.children.length;){const t=e.lastChild;t.children.length&&this._clearChildren(t),e.removeChild(t)}},_buildList(e,t){t.forEach(t=>{if(t.note)return void e.appendChild(this._getNote(t.note));const n=this._getRow(t.ID),r=this._getStateSwitch(e,t,{on:"enable",off:"disable"}),i=this._getFile(e,t,n),a=this._getEdit(t,e);n.appendChild(i),n.appendChild(a),n.appendChild(r),e.appendChild(n)})},_buildNav(e,t){e.paginate.innerHTML="";const n=document.createElement("button"),r=document.createElement("button");n.type="button",n.innerHTML="&lsaquo;",n.className="button cld-pagenav-prev",1===t.current_page?n.disabled=!0:n.addEventListener("click",n=>{e.currentPage=t.current_page-1,this._load(e.dataset.cachePoint)}),r.type="button",r.innerHTML="&rsaquo;",r.className="button cld-pagenav-next",t.current_page===t.total_pages||0===t.total_pages?r.disabled=!0:r.addEventListener("click",n=>{e.currentPage=t.current_page+1,this._load(e.dataset.cachePoint)});const i=document.createElement("span");if(i.innerText=t.nav_text,i.className="cld-pagenav-text",e.paginate.appendChild(n),e.paginate.appendChild(i),e.paginate.appendChild(r),e.paginate.appendChild(e.apply),e.apply.classList.remove("closed"),e.apply.disabled="disabled",t.items.length){const t=document.createElement("button");t.type="button",t.className="button",t.innerText=wp.i18n.__("Purge cache point","cloudinary"),t.style.float="right",e.paginate.appendChild(t),t.addEventListener("click",n=>{if(confirm(wp.i18n.__("Purge entire cache point?","cloudinary"))){t.dataset.parent=e.dataset.cachePoint;const n=this;t.classList.add("button-primary"),this._purgeAll(t,!1,function(){n._load(e.dataset.cachePoint)})}})}},_getNote(e){const t=this._getRow(),n=document.createElement("td");return n.colSpan=2,n.innerText=e,t.appendChild(n),t},_getRow(e){const t=document.createElement("tr");return e&&(t.id="row_"+e),t},_getEdit(e){const t=document.createElement("td"),n=document.createElement("a");return n.href=e.edit_url,e.data.transformations?n.innerText=e.data.transformations:n.innerText=H("Add transformations","cloudinary"),t.appendChild(n),t},_getFile(e,t){const n=document.createElement("td"),r=document.createElement("label"),i=this._getDeleter(e,n,t);r.innerText=t.short_url,r.htmlFor=t.key,n.appendChild(i),n.appendChild(r);const a=document.createElement("span"),s="spinner_"+t.ID;return a.className="spinner",a.id=s,n.appendChild(a),this.spinners[s]=a,n},_getDeleter(e,t,n){const r=document.createElement("input"),i=[e.dataset.slug+"_deleter"],a=this._getListIndex(e,n.ID,"delete");return r.type="checkbox",r.value=n.ID,r.id=n.key,r.dataset.main=JSON.stringify(i),-1<a&&(r.checked=!0,t.style.textDecoration="line-through"),r.addEventListener("change",i=>{t.style.opacity=1,t.style.textDecoration="",r.checked&&(t.style.opacity=.8,t.style.textDecoration="line-through");const a=new CustomEvent("CacheToggle",{detail:{checked:r.checked,states:{on:"delete",off:n.active?"enable":"disable"},item:n,cachePoint:e}});window.dispatchEvent(a)}),r},_getStateSwitch(e,t,n){const r=document.createElement("td"),i=document.createElement("label"),a=document.createElement("input"),s=document.createElement("span"),o=(e.dataset.slug,this._getListIndex(e,t.ID,"disable"));return r.style.textAlign="right",i.className="cld-input-on-off-control mini",a.type="checkbox",a.value=t.ID,a.checked=!(-1<o)&&t.active,s.className="cld-input-on-off-control-slider",i.appendChild(a),i.appendChild(s),a.addEventListener("change",r=>{const i=new CustomEvent("CacheToggle",{detail:{checked:a.checked,states:n,item:t,cachePoint:e}});window.dispatchEvent(i)}),r.appendChild(i),r}},Ce=document.getElementById("cloudinary-settings-page");Ce&&(Ee.init(),window.addEventListener("load",()=>Ae.init(Ce,Ee)))})()})();