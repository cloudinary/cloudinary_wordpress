(()=>{var e={"./node_modules/@wordpress/api-fetch/build-module/index.js":()=>{throw new Error("Module build failed: Error: ENOENT: no such file or directory, open '/Users/gabriel/Local Sites/cloudinary/app/public/wp-content/plugins/cloudinary_wordpress/node_modules/@wordpress/api-fetch/build-module/index.js'")},"./node_modules/@wordpress/i18n/build-module/index.js":()=>{throw new Error("Module build failed: Error: ENOENT: no such file or directory, open '/Users/gabriel/Local Sites/cloudinary/app/public/wp-content/plugins/cloudinary_wordpress/node_modules/@wordpress/i18n/build-module/index.js'")},"./src/js/components/asset-editor.js":(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});i("./node_modules/@wordpress/i18n/build-module/index.js");var s=i("./node_modules/@wordpress/api-fetch/build-module/index.js");const r={id:null,post_id:null,transformations:null,beforeCallbacks:[],completeCallbacks:[],init(e){if(void 0!==cldData.editor)return s.default.use(s.default.createNonceMiddleware(cldData.editor.nonce)),this.callback=e,this},save(e){this.doBefore(e),(0,s.default)({path:cldData.editor.save_url,data:e,method:"POST"}).then(e=>{this.doComplete(e,this)})},doBefore(e){this.beforeCallbacks.forEach(t=>t(e,this))},doComplete(e){this.completeCallbacks.forEach(t=>t(e,this))},onBefore(e){this.beforeCallbacks.push(e)},onComplete(e){this.completeCallbacks.push(e)}}},"./src/js/components/asset-preview.js":(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var s=i("./node_modules/@wordpress/i18n/build-module/index.js");const r={preview:null,wrap:null,apply:null,url:null,defaultWidth:null,defaultHeight:null,maxSize:null,init(){return this},createPreview(e=400,t=300){return this.maxSize=e>t?e:t,this.defaultWidth=e,this.defaultHeight=t,this.wrap=document.createElement("div"),this.apply=document.createElement("button"),this.preview=document.createElement("img"),this.apply.type="button",this.apply.classList.add("button-primary"),this.apply.innerText=(0,s.__)("Preview","cloudinary"),this.preview.style.transition="opacity 1s",this.preview.style.opacity=1,this.preview.style.maxWidth="100%",this.preview.style.maxHeight="100%",this.reset(),this.wrap.style.minHeight="200px",this.wrap.style.width=this.maxSize+"px",this.wrap.style.position="relative",this.wrap.style.display="flex",this.wrap.style.alignItems="center",this.wrap.style.justifyContent="center",this.apply.style.position="absolute",this.apply.style.display="none",this.wrap.appendChild(this.preview),this.wrap.appendChild(this.apply),this.preview.addEventListener("load",e=>{this.preview.style.opacity=1,this.wrap.style.width="",this.wrap.style.height="",this.defaultHeight=this.preview.height,this.defaultWidth=this.preview.width,this.defaultHeight>this.defaultWidth?this.wrap.style.height=this.maxSize+"px":this.wrap.style.width=this.maxSize+"px"}),this.preview.addEventListener("error",e=>{this.preview.src=this.getNoURL("⚠")}),this.apply.addEventListener("click",()=>{this.apply.style.display="none",this.reset(),this.preview.style.opacity=.6,this.preview.src=this.url}),this.wrap},reset(){this.preview.src=this.getNoURL()},setSrc(e,t=!1){this.preview.style.opacity=.6,t?(this.apply.style.display="none",this.preview.src=e):(this.apply.style.display="block",this.url=e)},getNoURL(e="︎"){const t=this.defaultWidth/2-23,i=this.defaultHeight/2+25;return`data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="${this.defaultWidth}" height="${this.defaultHeight}"><style>.error { font: normal 50px sans-serif; fill:rgb(255,0,0); }</style><rect width="100%" height="100%" style="fill:rgba(0,0,0,0.2);"></rect><text x="${t}" y="${i}" class="error">${e}</text></svg>`}}}},t={};function i(s){var r=t[s];if(void 0!==r)return r.exports;var l=t[s]={exports:{}};return e[s](l,l.exports,i),l.exports}i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};(()=>{"use strict";i.r(s),i.d(s,{default:()=>l});i("./node_modules/@wordpress/i18n/build-module/index.js");var e=i("./src/js/components/asset-preview.js"),t=i("./src/js/components/asset-editor.js");const r={wrap:document.getElementById("cld-asset-edit"),preview:null,id:null,editor:null,base:null,publicId:null,size:null,transformationsInput:document.getElementById("cld-asset-edit-transformations"),saveButton:document.getElementById("cld-asset-edit-save"),currentURL:null,init(){const e=JSON.parse(this.wrap.dataset.item);this.id=e.ID,this.base=e.base+e.size+"/",this.publicId=e.file,this.transformationsInput.value=e.transformations?e.transformations:"",this.initPreview(),this.initEditor()},initPreview(){this.preview=e.default.init(),this.wrap.appendChild(this.preview.createPreview(900,675)),this.preview.setSrc(this.base+this.transformationsInput.value+this.publicId,!0),this.transformationsInput.addEventListener("input",e=>{this.preview.setSrc(this.base+this.transformationsInput.value+this.publicId)}),this.transformationsInput.addEventListener("keydown",e=>{"Enter"===e.code&&(e.preventDefault(),this.saveButton.dispatchEvent(new Event("click")))})},initEditor(){this.editor=t.default.init(),this.editor.onBefore(()=>this.preview.reset()),this.editor.onComplete(e=>{this.transformationsInput.value=e.transformations,this.preview.setSrc(this.base+e.transformations+this.publicId,!0),e.note&&alert(e.note)}),this.saveButton.addEventListener("click",()=>{this.editor.save({ID:this.id,transformations:this.transformationsInput.value})})}};window.addEventListener("load",()=>r.init());const l=r})()})();
//# sourceMappingURL=asset-edit.js.map